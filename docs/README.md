# Мікросервіси для sentiment analysis

## Що таке мікросервіси?
<br>"Мікросервіси" - ще один новий термін на галасливих вулицях розробки ПЗ. І хоча ми зазвичай досить насторожено ставимося до всіх подібних новинок, саме цей термін визначає стиль розробки ПЗ, який ми знаходимо все більш привабливим. За останні кілька років ми бачили безліч проектів, які використовують цей стиль, і результати досі були дуже позитивними. Настільки, що більшість наших колег цей стиль стає основним стилем розробки ПЗ. На жаль, існує не так багато інформації, яка описує, чим є мікросервіси і як застосовувати їх.</br>
<br>Якщо коротко, то архітектурний стиль мікросервісів - це підхід, при якому єдиний додаток будується як набір невеликих сервісів, кожен з яких працює у своєму процесі та комунікує з іншими використовуючи легковажні механізми, як правило, HTTP. Ці послуги побудовані навколо бізнес-потреб і розгортаються незалежно з використанням повністю автоматизованого середовища. Існує абсолютний мінімум централізованого керування цими сервісами. Самі собою ці послуги можуть бути написані різними мовами і використовувати різні технології зберігання даних.</br>
<br>В даному проекті я розповім як працюють мікросервіси на прикладі застосунку, який основан на мікросервісах. Наша програма буде виконувати таку функцію: вона приймає, як вхідні дані, якесь словосполучення чи речення, після чого, використовуючи sentiment analysis, ми отримуюємо оцінку емоційного відношення автора пропозиції до якогось об'єкта.</br>

**Ось так вигрядає вікно цього застосунку**

![microservices](https://github.com/t1pUr/edu-dis-labs/blob/master/src/images/app.gif)
<br>Джерело: https://habrastorage.org/getpro/habr/post_images/674/7e1/415/6747e14151585819867c880f52fa9d21.gif

<br>З технічної точки зору програма складається з трьох мікросервісів, кожен з яких вирішує певний набір завдань:</br>

- SA-Frontend – веб-сервер Nginx, який обслуговує статичні файли React.
- SA-WebApp — веб-програма, написана на Java, яка обробляє запити від фронтенду.
- SA-Logic — програма Python, яка виконує аналіз тональності тексту.

Мікросервіси існують не в ізоляції. Вони реалізують ідею «поділу обов'язків», але їм, у своїй, необхідно взаємодіяти одне з одним.

**Наглядний приклад того як це все працює**

![microservices](https://github.com/t1pUr/edu-dis-labs/blob/master/src/images/app_work.gif)
<br>Джерело: https://habrastorage.org/getpro/habr/post_images/94b/f93/0c0/94bf930c03220c1eec6957a0f7308046.gif

<br>На схемі, показаній вище, можна побачити пронумеровані етапи роботи системи, що ілюструють потоки даних у додатку. Розберемо їх:

1. Браузер запитує сервера файл index.html (який, в свою чергу, робить завантаження пакета React-программы).
2. Користувач взаємодіє з програмою, це викликає звернення до веб-застосунку, заснованого на Spring.
3. Веб-програма перенаправляє запит на виконання аналізу тексту Python-додатку.
4. Python-додаток проводить аналіз тональності тексту та повертає результат у вигляді відповіді на запит.
5. Spring-програма відправляє відповідь React-програмі (а вона, у свою чергу, показує результат аналізу тексту користувачеві).</br>

## Запуск програми, що базується на мікросервісах, на локальному комп'ютері
<br>Одразу зазначу, що весь код знаходиться у каталогу src/code. Для того, щоб програма працювала коректно, нам потрібно запустити всі три мікросервіси. Почнемо з самого красивого - з фронтенд-додатку.</br>

**Налаштування React для локальної розробки**
<br>Сподіваюсь, що у вас вже встановлений Node.js та NPM, тому перейдемо в каталог *sa-frontend* та виконаємо команду.</br>
> npm install

<br>Завдяки виконанню цієї команди в папку node_modules будуть завантажені залежності програми React, записи про які є у файлі package.json. Після завершення завантаження залежностей у тій самій папці виконайте таку команду:</br>
> npm start

<br>Тепер програма React запущена, доступ до неї можна отримати, перейшовши в браузері за адресою **localhost:3000**. Можете щось змінити в його коді. Ефект від цих змін ви побачите в браузері. Це можливо завдяки так званій гарячій заміні модулів. Завдяки цьому фронтенд-розробка перетворюється на просте та приємне заняття.</br>

**Підготовка React-додатка до виведення у продакшн**
<br>Для справжнього використання React-програми нам потрібно перетворити його на набір статичних файлів і віддавати їх клієнтам, використовуючи веб-сервер.Для складання програми React, знову, використовуючи термінал, перейдіть до папки sa-frontend і виконайте наступну команду:</br>
>npm run build

<br>Це спричинить створення в папці проекту директорії build. У ній будуть утримуватися всі статичні файли, необхідні для роботи програми React.</br>

**Обслуговування статичних файлів засобами Nginx**
<br>Для початку потрібно встановити та запустити веб-сервер Nginx. Потім потрібно скопіювати вміст папки sa-frontend/build у папку [your_nginx_installation_dir]/html.</br>
<br>При такому підході файл index.html, що згенерований у процесі складання React-додатка, буде доступний за адресою [your_nginx_installation_dir]/html/index.html. Це файл, який за замовчуванням Nginx-сервер видає при зверненні до нього. Сервер настроєний на прослуховування порту 80, але його можна налаштувати так, як вам потрібно, відредагувавши файл [your_nginx_installation_dir]/conf/nginx.conf.

Тепер відкрийте браузер і перейдіть на адресу localhost:80. Ви побачите сторінку програми React.</br>
![microservices](https://github.com/t1pUr/edu-dis-labs/blob/master/src/images/result1.png)
